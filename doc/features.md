# Document Encoder 機能詳細一覧

本ドキュメントは、デスクトップ版（Tauri/React）の既存コードベースに基づいた、各画面の機能詳細を網羅したものである。Web版への移植における機能要件のベースラインとして利用する。

## 1. 画面遷移図
- **メインダッシュボード (MainDashboard)** [ホーム]
    - [設定ボタン] -> **設定画面 (Settings)**
        - [オープンソースライセンス] -> **ライセンス表示 (LicenseDisplay)**
    - [プロンプト設定ボタン] -> **プロンプト設定画面 (PromptSettings)**
        - [新規/編集] -> **プリセット編集モーダル (PresetEditModal)**

## 2. 各画面機能詳細

### 2.1. メインダッシュボード (MainDashboard)
アプリケーションのメイン画面。動画の選択からドキュメント生成、結果確認までを行う。

#### A. ヘッダー
- **設定ボタン**: 設定画面へ遷移する。
- **プロンプト設定ボタン**: プロンプト設定画面へ遷移する。

#### B. 左ペイン（設定・操作）

**1. 動画ソース選択**
- **タブ切り替え**: 「ローカルファイル」と「YouTube」を切り替え可能。
- **ローカルファイルモード**:
    - **ファイル選択ボタン**: OSのファイル選択ダイアログを開き、動画ファイルを選択する。複数選択可。
    - **選択ファイルリスト**:
        - ファイル名、サイズ、再生時間（`get_video_duration`）を表示。
        - 削除ボタンでリストから除外可能。
- **YouTubeモード**:
    - **URL入力欄**: YouTubeの動画URLを入力。ID自動抽出機能あり。
    - **タイトル入力欄**: 動画タイトルを入力（保存ファイル名に使用）。

**2. プロンプト設定**
- **プリセット選択**: 事前定義されたプロンプトプリセットをプルダウンから選択。選択すると下部のテキストエリアに反映される。
- **出力言語**: 生成ドキュメントの言語を選択（日本語 / English）。
- **動画低容量化**: 動画の解像度変換設定（変換なし / 1080p / 720p / 480p）。※Web版では `ffmpeg.wasm` の負荷を考慮し要検討。
- **画像埋め込み設定** (ローカルファイルのみ):
    - **有効化チェックボックス**: ドキュメントへのスクリーンショット埋め込みを有効にする。
    - **埋込頻度**: Minimal（少なめ）/ Moderate（普通）/ Detailed（多め）から選択。頻度に応じてプロンプトに追加指示が挿入される。
- **プロンプト編集エリア**:
    - 現在のプロンプトを直接編集可能なテキストエリア。
    - プリセット選択時に内容が上書きされる。

**3. 保存設定**
- **保存先変更ボタン**: 生成物の保存先ディレクトリを選択するダイアログを開く。
- **プレビュー表示**: 現在の保存先パスと、生成予定のファイル名を表示。

**4. 生成実行**
- **ドキュメント生成ボタン**: 処理を開始する。
    - 未入力項目がある場合や処理中は無効化される。
    - ローカル/YouTubeモードに応じて処理を分岐。

#### C. 右ペイン（処理状況・結果）

**1. 処理状況 (Progress Section)**
- **ステータスメッセージ**: 現在の処理内容（例：「ファイルアップロード中...」）を表示。
- **プログレスバー**: 全体の進捗率を可視化。
- **進捗ステップ表示**: 現在のステップ数 / 全ステップ数。

**2. 処理ログ (Log Section)**
- **ログ表示エリア**: 詳細な処理ログを時系列で表示。
- **自動スクロール**: 新しいログが追加されると自動で最下部へスクロール。
- **操作ボタン**:
    - 表示/非表示切り替え
    - ログクリア

**3. 生成結果 (Result Section)**
- **プレビュー表示**: 生成されたMarkdownテキストを表示。
- **自動保存**: 生成完了時にファイルへ自動保存される。

---

### 2.2. 設定画面 (Settings)
アプリケーション全体の動作設定を行う画面。

#### A. LLM設定
- **Gemini API Key**: Google Gemini APIのキーを入力（パスワード形式表示）。
- **Temperature**: 生成のランダム性を0.0〜1.0で設定（デフォルト: 0.0）。
- **Gemini Model**: 使用するモデルを選択（`gemini-2.5-pro`, `gemini-2.5-flash` 等）。

#### B. 動画処理設定
- **ハードウェアエンコード**: 有効にするとGPUを利用したエンコードを試みる（Tauri版機能）。※Web版ではブラウザの対応状況に依存、または無効化。

#### C. 実験用機能
- **実験機能有効化**: 開発中の機能を有効にするトグル。
- **フレーム抽出方法**:
    - Standard（標準・安定版）
    - Fast（高速版）
    - Multiple（複数同時処理）

#### D. アプリケーション情報
- **オープンソースライセンスボタン**: ライセンス表示画面へ遷移する。

#### E. アクションボタン
- **保存**: 設定を保存してメイン画面へ戻る。
    - APIキー等の機密情報は暗号化して保存（Tauri版実装）。Web版ではLocalStorage等への保存となる。
- **キャンセル**: 変更を破棄してメイン画面へ戻る。

---

### 2.3. プロンプト設定画面 (PromptSettings)
プロンプトのプリセット（テンプレート）を管理する画面。

#### A. プリセット一覧
- 保存されているプリセットをリスト表示。
- **デフォルトバッジ**: 削除・編集不可のシステム標準プリセット（「デフォルト（マニュアル）」「デフォルト（仕様書）」）を明示。
- **操作ボタン** (ユーザー定義プリセットのみ):
    - **編集**: 編集モーダルを開く。
    - **削除**: 削除確認を表示して削除する。

#### B. 管理アクション
- **新規プリセット作成**: 空の状態で編集モーダルを開く。
- **XMLファイルから読み込み**: 外部XMLファイルからプリセットを一括インポートする。ID重複時は自動リネーム。
- **XMLファイルにエクスポート**: ユーザー定義プリセットをXML形式でファイル出力する。

---

### 2.4. プリセット編集モーダル (PresetEditModal)
プリセットの新規作成・編集を行うダイアログ。

- **プリセット名**: プリセットの表示名を入力。
- **プロンプト**: テンプレートとなるプロンプト本文を入力。
- **保存/作成ボタン**: 入力内容を保存し、プリセットリストを更新する。
- **キャンセルボタン**: 編集を破棄して閉じる。

---

### 2.5. ライセンス表示画面 (LicenseDisplay)
- 使用しているサードパーティライブラリのライセンス条文を表示する。
- `licenses.json` などの定義ファイルから動的にリストを生成。
